#This is testing workflow

**start
step_no = 1
cal_name = str opt

kpoints_type = MPRelaxSet
denser_kpoints = 1

*begin(add_new_incar_tags)
ISIF = 2
ISMEAR = 0
LCHARG = .TRUE.
NPAR   = 4
IVDW   = 12
EDIFF  = 1.0E-4
EDIFFG = -0.03
*end(add_new_incar_tags)

remove_incar_tags = MAGMOM
comment_incar_tags = ISPIN, LORBIT

job_submission_script = /xxx/vasp.lsf #the absolute path of the job submission script
job_submission_command = bsub < vasp.lsf > job_id

###############################################################
###These parameters are required in the first step.
force_gamma = Yes
2d_system = Yes   #If Yes, KPOINTS generated by pymatgen will be modified so that all kpoints have zero-K_z

job_query_command = bjobs@-w             #@ replaces spaces
job_killing_command = bkill
where_to_parse_queue_id = job_id
re_to_parse_queue_id = <([0-9]+)>    #based on re.findall
queue_stdout_file_prefix = lsf
queue_stdout_file_suffix = .o
queue_stderr_file_prefix = lsf
queue_stderr_file_suffix = .e
vasp.out = out
##################################################################
**end



**start
step_no = 2
cal_name = consecutive str opt

copy_from_prev_cal = INCAR, KPOINTS, POSCAR, POTCAR
move_from_prev_cal = CHGCAR
contcar_to_poscar = Yes

*begin(add_new_incar_tags)
ICHARG = 1
IDIPOL = 3
LDIPOL = .TRUE.
EDIFFG = -0.02
*end(add_new_incar_tags)

job_submission_script = /xxx/vasp.lsf #the absolute path of the job submission script
job_submission_command = bsub < vasp.lsf > job_id
**end

**start
step_no = 3
cal_name = scf

copy_from_prev_cal = INCAR, CONTCAR, POTCAR
contcar_to_poscar = Yes
kpoints_type = MPStaticSet
denser_kpoints = 1.5

*begin(add_new_incar_tags)
ICHARG = 2
ISMEAR = -5
LSORBIT = .TRUE.
LORBIT = 11
ISYM = 0
GGA_COMPAT = .FALSE.
ALGO  = Normal
*end(add_new_incar_tags)

comment_incar_tags = IBRION, ISIF, NSW, EDIFFG

job_submission_script = /xxx/vasp_ncl.lsf
job_submission_command = bsub < vasp_ncl.lsf > job_id
**end


**start
step_no = 4
cal_name = band structure

copy_from_prev_cal = INCAR, POSCAR, CHGCAR, POTCAR
copy_which_step = 3

kpoints_type = MPNonSCFSet_line
kpoints_line_density = 20

*begin(add_new_incar_tags)
ICHARG = 11
LORBIT = 11
LCHARG = .FALSE.
ISMEAR = 0
LCHARG = .FLASE.
*end(add_new_incar_tags)

job_submission_script = /xxx/vasp_ncl.lsf
job_submission_command = bsub < vasp_ncl.lsf > job_id
**end


**start
step_no = 5
cal_name = dos

copy_from_prev_cal = INCAR, POSCAR, CHGCAR, POTCAR
copy_which_step = 3

kpoints_type = MPStaticSet
denser_kpoints = 2


*begin(add_new_incar_tags)
NEDOS = 601
ICHARG = 11
LORBIT = 11
ISMEAR = 0
LCHARG = .FALSE.
*end(add_new_incar_tags)

job_submission_script = /xxx/vasp_ncl.lsf
job_submission_command = bsub < vasp_ncl.lsf > job_id
**end
